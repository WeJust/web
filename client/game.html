<!DOCTYPE html>
<html>
<head>
         <title>Run...</title>
      <!--Import Google Icon Font-->
      <link href="http://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
      <!--Import materialize.css-->
      <link type="text/css" rel="stylesheet" href="css/materialize.min.css"  media="screen,projection"/>
      <!--Let browser know website is optimized for mobile-->
      <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <!-- link to the last version of babylon -->
    <script src="js/sources/babylon.js"></script>
    <style>
    html, body {
        overflow: hidden;
        width   : 100%;
        height  : 100%;
        margin  : 0;
        padding : 0;
        /*cursor : url("css/cursor_orange.png"), pointer;*/
    }

    #renderCanvas {
        width   : 100%;
        height  : 100%;
        touch-action: none;
    }
</style>
</head>
<body>
      <nav>
    <div class="nav-wrapper black">
      <a href="/" class="brand-logo">StayHigh!</a>
      <ul class="right hide-on-med-and-down">
        <li><a href="/l2p">Learn to play</a></li>
      <li><a class="waves-effect waves-light btn green" href="/account">My Account</a></li>
        <li><a class="waves-effect waves-light btn red" href = "/logout">Logout</a></li>
      </ul>
    </div>
  </nav>
  
  
    <canvas id="renderCanvas"></canvas>
    <script type="text/javascript" src="js/gamefiles/includes/materials.js"></script>
    <script type="text/javascript" src="js/gamefiles/includes/gameobjects.js"></script>
    <script type="text/javascript" src="js/gamefiles/includes/camera.js"></script>
    <script type="text/javascript" src="js/gamefiles/includes/light.js"></script>
    <script type="text/javascript" src="js/gamefiles/includes/update.js"></script>
     <script type="text/javascript" src="js/gamefiles/includes/inputevents.js"></script>
    <script type="text/javascript" src="js/gamefiles/scene.js"></script>
    <script src="/socket.io/socket.io.js"></script>
     <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.2/rollups/aes.js"></script>
    <script>
    var QueryString = function () {
  // This function is anonymous, is executed immediately and 
  // the return value is assigned to QueryString!
  var query_string = {};
  var query = window.location.search.substring(1);
  var vars = query.split("&");
  for (var i=0;i<vars.length;i++) {
    var pair = vars[i].split("=");
        // If first entry with this name
    if (typeof query_string[pair[0]] === "undefined") {
      query_string[pair[0]] = decodeURIComponent(pair[1]);
        // If second entry with this name
    } else if (typeof query_string[pair[0]] === "string") {
      var arr = [ query_string[pair[0]],decodeURIComponent(pair[1]) ];
      query_string[pair[0]] = arr;
        // If third or later entry with this name
    } else {
      query_string[pair[0]].push(decodeURIComponent(pair[1]));
    }
  } 
  return query_string;
}();



    document.addEventListener("contextmenu", function(e){
    e.preventDefault();
}, false);
      var canvas = document.getElementById('renderCanvas');
var engine = new BABYLON.Engine(canvas, true);
 var socket = io.connect();

var gvars = {};
gvars["rotY"] = 0;
gvars["dx"] = 0;
gvars["dy"] = 0;
gvars["dz"] = 0;
gvars["user"] =  CryptoJS.AES.decrypt(QueryString.u, "tomiproject").toString(CryptoJS.enc.Utf8);
console.log("user decrypt = "+gvars["user"]);
gvars["jumpFactor"] = 0;
gvars["rope_direction"] = new BABYLON.Vector3(0,0,0);
gvars["rope_distance"] = 0;
gvars["rope_distanceMax"] = 0;
var scene = createScene();


scene.executeWhenReady(function () {
    
  engine.runRenderLoop(function() {
    scene.render();
});  
});


window.addEventListener('resize', function() {
    engine.resize();
    
    
});  

    </script>
     <script src="https://www.gstatic.com/firebasejs/3.6.3/firebase.js"></script>
    <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
    <script type="text/javascript" src="js/sources/materialize.min.js"></script>
    <script src="js/sources/angular.min.js"></script>
</body>
</html>